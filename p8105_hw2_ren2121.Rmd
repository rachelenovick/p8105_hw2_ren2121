---
title: "p8105_hw2_ren2121"
output: html_document
date: "2025-09-26"
---

Loading the tidyverse library.

```{r}
library(tidyverse)
library(readxl)
library(lubridate)
```

# Problem 1

Importing and cleaning the pols-month dataset:

```{r}

pols_month_df =
  read_csv("538_data/pols-month.csv", na = c("NA", ".", "")) |> 
  separate(mon, into = c("year", "month", "day")) |> 
   mutate(
    year = as.integer(year),
    month = as.integer(month),                 
    month = month.name[month],                  
    month = factor(month, levels = month.name),
    president = case_when(
      prez_dem == 1 ~ "dem",
      prez_dem == 0 ~ "gop")) |> 
  select(-prez_dem, -prez_gop, -day)

```

Importing and cleaning the snp dataset:

```{r}

snp_df =
  read_csv("538_data/snp.csv", na = c("NA", ".", "")) |> 
  separate(date, into = c("month", "day", "year")) |> 
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    year = if_else(year >= 50, 1900 + year, 2000 + year),
    month = month.name[month],
    month = factor(month, levels = month.name)) |> 
  relocate(year, month) |> 
  arrange(year, month)

```

Importing and cleaning the unemployment dataset:

```{r}

unemployment_df =
  read_csv("538_data/unemployment.csv", na = c("NA", ".", "")) |> 
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment") |> 
  mutate(
    year = as.integer(Year),                     
    month = month.name[match(month, month.abb)],
    month = factor(month, levels = month.name)) |>  
  select(-Year) |> 
  relocate(year)

```

Joining the datasets:

```{r}
snp_pols_df = 
  full_join(snp_df, pols_month_df, by = c("year", "month"))

full_df = 
  full_join(snp_pols_df, unemployment_df, by = c("year", "month")) |> 
  arrange(year, month)
```

**Description of the datasets**

The pols-month dataset has 822 observations and 9 variables (after cleaning), and provides information on the number of national politicians who are democratic or republican at any given time. It contains variables including: year, month, whether the president was republican or democrat, and the number of democratic and republic senators, governors, and representatives on those associated date.

The snp dataset has 787 observations and 4 variables (after cleaning), and provides information on the S&P. The variables included are: year, month, day, and close (the closing values of the S&P stock index on the associated date).

The unemployment dataset contains 68 observations and 3 variables (after cleaning), and provides information on the percentage of unemployment by date. The variables it includes are: year, month, and % unemployment associated with the month/year.

The resulting fully joined dataset has 828 observations and 12 variables: year, month, day, unemployment, president party, close, and the number of democratic and republican senators, governors, and representatives on the associated dates.

# Problem 2

Reading in and cleaning the Mr. Trash Wheel dataset:

```{r}

mr_trash = 
  read_excel("trash_data.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N653") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    sports_balls = as.integer(round(sports_balls)),
    year = as.integer(year),
    day = day(date),  
    wheel = "mr") |> 
  select(-date) |>  
  relocate(wheel, .after = dumpster) |> 
  relocate(year, month, day, .after = wheel) |> 
  relocate(sports_balls, .after = last_col())

```

Reading in and cleaning the Professor Trash Wheel dataset:

```{r}

prof_trash = 
  read_excel("trash_data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M120") |> 
  janitor::clean_names()|> 
   mutate(
    day = day(date),
    wheel = "prof") |> 
  select(-date) |> 
  relocate(wheel, .after = dumpster) |> 
  relocate(year, month, day, .after = wheel)

```

Reading in and cleaning the Gwynnda dataset:

```{r}

gwynnda_trash = 
  read_excel("trash_data.xlsx", sheet = "Gwynnda Trash Wheel", range = "A2:L265") |> 
  janitor::clean_names() |> 
  mutate(
    day = day(date),
    wheel = "gwynnda") |> 
  select(-date) |> 
  relocate(wheel, .after = dumpster) |> 
  relocate(year, month, day, .after = wheel)

```

Joining the datasets:

```{r}

full_trash = 
  full_join(mr_trash, prof_trash, by = NULL) |> 
  full_join(gwynnda_trash, by = NULL)

```

**Description of the datasets**

The Mr. Trash Wheel, Professor Trash Wheel, and Gwynnda Trash Wheel all provide data on the amount, type, and date of collection of trash by each respective trash wheel as well as the number of homes they powered by running. They all contain the following variables: `r paste(names(prof_trash), collapse = ", ")`. Mr. Trash Wheel also contains a variable for the number of sports balls collected. In the final joined dataset, there are `r nrow(full_trash)` total observations.

For available data, the total weight of trash collected by Professor Trash Wheel was `r sum(full_trash[["weight_tons"]], na.rm = TRUE)` tons.

In June 2022, Gwynnda Trash Wheel collected `r sum(full_trash[["cigarette_butts"]][full_trash[["month"]] == "June" & full_trash[["year"]] == 2022], na.rm = TRUE)` cigarette butts.

# Problem 3

Importing and cleaning the zipcodes dataset:

```{r}

zipcodes_df = 
  read_csv("zillow_data/Zip_Codes.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
 mutate(
    file_date = mdy(file_date),  # or ymd(file_date) depending on format
    year = year(file_date),
    month = month(file_date),
    day = day(file_date)
  ) |> 
  select(-file_date) |> 
  relocate(year, month, day, county, zip_code)

```

Importing and cleaning the second dataset:

```{r}

zori_df =
  read_csv("zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv", na = c("NA", ".", "")) %>%
  pivot_longer(
    cols = 10:ncol(.),
    names_to = "date",
    values_to = "price"
  ) %>%
  mutate(
    # Remove leading X added by readr for numeric-looking column names
    date = str_remove(date, "^X"),
    # Replace underscores with hyphens to match "YYYY-MM-DD"
    date = str_replace_all(date, "_", "-"),
    date = ymd(date),
    year = year(date),
    month = month(date),
    day = day(date)
  ) %>%
  select(1:9, year, month, day, price)

```







